import{j as i,c as a,b as e,ah as t}from"./chunks/framework.Br27zpCu.js";const c=JSON.parse('{"title":"Guest Checkout","description":"","frontmatter":{},"headers":[],"relativePath":"bagisto-headless-ecommerce/features/checkout/checkout-flow/guest-checkout.md","filePath":"bagisto-headless-ecommerce/features/checkout/checkout-flow/guest-checkout.md","lastUpdated":1769687094000}'),n={name:"bagisto-headless-ecommerce/features/checkout/checkout-flow/guest-checkout.md"};function l(h,s,r,p,o,k){return e(),a("div",null,[...s[0]||(s[0]=[t(`<h1 id="guest-checkout" tabindex="-1">Guest Checkout <a class="header-anchor" href="#guest-checkout" aria-label="Permalink to &quot;Guest Checkout&quot;">‚Äã</a></h1><p>This guide explains how guest users can complete the checkout process without creating an account in the Bagisto Headless storefront.</p><h2 id="overview" tabindex="-1">Overview <a class="header-anchor" href="#overview" aria-label="Permalink to &quot;Overview&quot;">‚Äã</a></h2><p>Guest checkout allows users to make purchases quickly by providing only their email and address information during the checkout flow. The storefront manages these guest sessions using persisted tokens and local storage to ensure a seamless experience from cart addition to order placement.</p><h2 id="_1-guest-session-initialization" tabindex="-1">1. Guest Session Initialization <a class="header-anchor" href="#_1-guest-session-initialization" aria-label="Permalink to &quot;1. Guest Session Initialization&quot;">‚Äã</a></h2><p>As explained in the <a href="/bagisto-headless-ecommerce/features/cart/state-management/cart-persistence">Cart Persistence</a> guide, a guest session begins as soon as a user adds their first item to the cart.</p><ul><li><strong>Token Generation:</strong> A <code>GUEST_CART_TOKEN</code> is created and stored in cookies.</li><li><strong>Cart Context:</strong> Every subsequent request (fetching cart details, adding/removing items) includes this token to identify the user&#39;s specific guest cart on the Bagisto backend.</li></ul><h2 id="_2-guest-specific-checkout-steps" tabindex="-1">2. Guest-Specific Checkout Steps <a class="header-anchor" href="#_2-guest-specific-checkout-steps" aria-label="Permalink to &quot;2. Guest-Specific Checkout Steps&quot;">‚Äã</a></h2><p>While the overall checkout flow is the same for guests and customers, several components are specifically designed to handle guest data.</p><h3 id="email-step" tabindex="-1">Email Step <a class="header-anchor" href="#email-step" aria-label="Permalink to &quot;Email Step&quot;">‚Äã</a></h3><p>For guests, the <code>Email</code> component allows direct entry of their contact email. This email is stored in local storage to pre-populate subsequent address fields.</p><p><strong>File:</strong> <code>src/components/checkout/stepper/Email.tsx</code></p><div class="language-tsx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">tsx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> onSubmit</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> async</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">data</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> EmailFormValues</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // Store guest email locally for address pre-population</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  setLocalStorage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">EMAIL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, data?.email);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  router.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">push</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/checkout?step=address&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><h3 id="guest-address-form" tabindex="-1">Guest Address Form <a class="header-anchor" href="#guest-address-form" aria-label="Permalink to &quot;Guest Address Form&quot;">‚Äã</a></h3><p>The <code>GuestAddAdressForm</code> is used to collect billing and shipping information from non-authenticated users.</p><p><strong>File:</strong> <code>src/components/checkout/stepper/GuestAddAdressForm.tsx</code></p><div class="language-tsx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">tsx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> GuestAddAdressForm</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ({ </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">billingAddress</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">shippingAddress</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> email</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> getLocalStorage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">EMAIL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> addGuestAddress</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> async</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> payload</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      billingFirstName: data.billing.firstName,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      billingEmail: data.billing.email </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">??</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> email,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      // ... other guest billing/shipping fields</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    };</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // Save to Bagisto backend using the guest session token</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> saveCheckoutAddress</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(payload);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  };</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">form</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> onSubmit</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">handleSubmit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(addGuestAddress)}&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      {</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* Address fields here */</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">form</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  );</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><h2 id="_3-order-placement-for-guests" tabindex="-1">3. Order Placement for Guests <a class="header-anchor" href="#_3-order-placement-for-guests" aria-label="Permalink to &quot;3. Order Placement for Guests&quot;">‚Äã</a></h2><p>When a guest places an order, the <code>SavePlaceOrder</code> function handles the finalization and session cleanup.</p><p><strong>File:</strong> <code>src/utils/hooks/useCheckout.ts</code></p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> SavePlaceOrder</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> async</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> token</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> getCartToken</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 1. Send the place order mutation to Bagisto</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> placeOrder</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({ token });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 2. Perform checkout cleanup for the guest session</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> resetGuestToken</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><h3 id="post-order-cleanup" tabindex="-1">Post-Order Cleanup <a class="header-anchor" href="#post-order-cleanup" aria-label="Permalink to &quot;Post-Order Cleanup&quot;">‚Äã</a></h3><p>To ensure security and a clean state for future guest sessions:</p><ul><li><strong>Redux Reset:</strong> The <code>clearCart</code> action is dispatched to reset the global state.</li><li><strong>Token Reset:</strong> The <code>resetGuestToken</code> function deletes the <code>GUEST_CART_TOKEN</code> and <code>GUEST_CART_ID</code> cookies.</li><li><strong>Success Redirect:</strong> The user is redirected to the <code>/success</code> page where they can see their order summary.</li></ul><h2 id="_4-key-considerations" tabindex="-1">4. Key Considerations <a class="header-anchor" href="#_4-key-considerations" aria-label="Permalink to &quot;4. Key Considerations&quot;">‚Äã</a></h2><ul><li><strong>Session Longevity:</strong> Guest sessions are persisted via cookies for a defined period (e.g., 7 days) or until the order is placed.</li><li><strong>Customer Conversion:</strong> Guests are encouraged to log in via links in the email step, but it is not required.</li><li><strong>Data Privacy:</strong> Guest addresses and emails are sent over the secure GraphQL API and are only accessible via the specific session token until the order is finalized.</li></ul><h2 id="summary" tabindex="-1">Summary <a class="header-anchor" href="#summary" aria-label="Permalink to &quot;Summary&quot;">‚Äã</a></h2><ul><li><strong>Low Friction:</strong> No account creation required for order placement.</li><li><strong>Email Tracking:</strong> Captures guest email early for communication and address population.</li><li><strong>Session Managed:</strong> Uses secure tokens to link carts and checkout progress to the guest browser.</li><li><strong>Clean Transitions:</strong> Automatically handles session destruction after order success.</li></ul><h2 id="next-steps" tabindex="-1">Next Steps <a class="header-anchor" href="#next-steps" aria-label="Permalink to &quot;Next Steps&quot;">‚Äã</a></h2><ul><li>üîê <a href="/bagisto-headless-ecommerce/authentication/nextauth-setup">Customer Authentication</a> - How guest carts are merged into customer accounts.</li><li>üß± <a href="/bagisto-headless-ecommerce/features/checkout/checkout-flow/multi-step-checkout">Multi-step Checkout</a> - Full breakdown of the checkout stages.</li><li>üíæ <a href="/bagisto-headless-ecommerce/features/cart/state-management/cart-persistence">Cart Persistence</a> - Detailed look at guest token management.</li></ul>`,30)])])}const g=i(n,[["render",l]]);export{c as __pageData,g as default};
