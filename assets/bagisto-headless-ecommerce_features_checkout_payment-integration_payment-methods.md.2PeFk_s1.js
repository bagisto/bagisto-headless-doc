import{j as i,c as a,b as e,ah as t}from"./chunks/framework.Br27zpCu.js";const c=JSON.parse('{"title":"Payment Methods","description":"","frontmatter":{},"headers":[],"relativePath":"bagisto-headless-ecommerce/features/checkout/payment-integration/payment-methods.md","filePath":"bagisto-headless-ecommerce/features/checkout/payment-integration/payment-methods.md","lastUpdated":1768233865000}'),n={name:"bagisto-headless-ecommerce/features/checkout/payment-integration/payment-methods.md"};function h(l,s,p,o,r,k){return e(),a("div",null,[...s[0]||(s[0]=[t(`<h1 id="payment-methods" tabindex="-1">Payment Methods <a class="header-anchor" href="#payment-methods" aria-label="Permalink to &quot;Payment Methods&quot;">‚Äã</a></h1><p>This guide explains how payment methods are fetched, selected, and processed within the Bagisto Headless checkout flow.</p><h2 id="overview" tabindex="-1">Overview <a class="header-anchor" href="#overview" aria-label="Permalink to &quot;Overview&quot;">‚Äã</a></h2><p>In the fourth step of the checkout process, users select their preferred payment method (e.g., Cash on Delivery, Money Transfer, or online gateways like PayPal/Stripe). The storefront dynamically fetches eligible methods based on the billing address and order total, ensuring only applicable options are displayed.</p><h2 id="_1-fetching-available-methods" tabindex="-1">1. Fetching Available Methods <a class="header-anchor" href="#_1-fetching-available-methods" aria-label="Permalink to &quot;1. Fetching Available Methods&quot;">‚Äã</a></h2><p>Similar to shipping methods, payment options are retrieved from the backend once the address information is saved. The <code>useQuery</code> hook fetches this data based on the active cart token.</p><p><strong>File:</strong> <code>src/components/checkout/stepper/payment/index.tsx</code></p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">isLoading</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> useQuery</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  queryKey: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;paymentMethods&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, token],</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  queryFn</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    fetchHandler</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      url: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;checkout/paymentMethods&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      method: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;POST&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      body: { token },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div><h2 id="_2-selection-ui" tabindex="-1">2. Selection UI <a class="header-anchor" href="#_2-selection-ui" aria-label="Permalink to &quot;2. Selection UI&quot;">‚Äã</a></h2><p>Payment methods are displayed using an accessible radio group. Each option includes a title and a brief description providing clarity on the payment terms.</p><p><strong>File:</strong> <code>src/components/checkout/stepper/payment/PaymentMethod.tsx</code></p><div class="language-tsx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">tsx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">RadioGroup</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{field.value} </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">onValueChange</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{field.onChange}&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  {methods.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">map</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">method</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">CustomRadio</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      key</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{method.method}</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      description</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{method.description}</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{method.method}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      {method.title}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">CustomRadio</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ))}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">RadioGroup</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><h2 id="_3-saving-the-payment-selection" tabindex="-1">3. Saving the Payment Selection <a class="header-anchor" href="#_3-saving-the-payment-selection" aria-label="Permalink to &quot;3. Saving the Payment Selection&quot;">‚Äã</a></h2><p>Once a user selects a method and clicks &quot;Pay Now&quot;, the selection is persisted to the Bagisto backend.</p><h3 id="graphql-mutation" tabindex="-1">GraphQL Mutation <a class="header-anchor" href="#graphql-mutation" aria-label="Permalink to &quot;GraphQL Mutation&quot;">‚Äã</a></h3><p>The <code>CREATE_CHECKOUT_PAYMENT_METHODS</code> mutation handles the association between the cart and the selected gateway. It also accepts redirect URLs for online payments.</p><p><strong>File:</strong> <code>src/graphql/checkout/mutations/CreateCheckoutPaymentMethod.ts</code></p><div class="language-graphql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">graphql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">mutation</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> CreateCheckoutPaymentMethod</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">$token</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">String</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">$paymentMethod</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">String</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  createCheckoutPaymentMethod</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">input</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    token</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">$token</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    paymentMethod</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">$paymentMethod</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # Optional redirect URLs for external gateways</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    paymentSuccessUrl</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/success&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    paymentFailureUrl</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/checkout?step=payment&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }) {</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    checkoutPaymentMethod</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">      success</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">      message</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">      paymentGatewayUrl</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # Provided if an external redirect is required</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="hook-implementation" tabindex="-1">Hook Implementation <a class="header-anchor" href="#hook-implementation" aria-label="Permalink to &quot;Hook Implementation&quot;">‚Äã</a></h3><p>The <code>useCheckout</code> hook manages the submission and transitions the user to the final <strong>Review</strong> step.</p><p><strong>File:</strong> <code>src/utils/hooks/useCheckout.ts</code></p><h2 id="_4-navigation-redirects" tabindex="-1">4. Navigation &amp; Redirects <a class="header-anchor" href="#_4-navigation-redirects" aria-label="Permalink to &quot;4. Navigation &amp; Redirects&quot;">‚Äã</a></h2><ul><li><strong>Offline Methods:</strong> For methods like &quot;Cash on Delivery&quot;, the user is simply advanced to the <code>review</code> step.</li><li><strong>Online Gateways:</strong> If the selected method requires external authorization (e.g., Stripe, PayPal), the API may return a <code>paymentGatewayUrl</code>. The storefront can then redirect the user to complete the transaction on the provider&#39;s secure page.</li></ul><h2 id="summary" tabindex="-1">Summary <a class="header-anchor" href="#summary" aria-label="Permalink to &quot;Summary&quot;">‚Äã</a></h2><ul><li><strong>Contextual Options:</strong> Displays only the payment methods supported by the current store configuration and user location.</li><li><strong>Incremental Progress:</strong> Saves the choice to the backend immediately upon selection.</li><li><strong>Rich Feedback:</strong> Provides descriptions for each method to help users make informed decisions.</li><li><strong>Flexible Extensions:</strong> The architecture supports both standard offline payments and complex online gateway redirects.</li></ul><h2 id="next-steps" tabindex="-1">Next Steps <a class="header-anchor" href="#next-steps" aria-label="Permalink to &quot;Next Steps&quot;">‚Äã</a></h2><ul><li>üîç <a href="/bagisto-headless-ecommerce/features/checkout/payment-integration/order-confirmation">Order Review</a> - The final step before order placement.</li><li>üì¶ <a href="/bagisto-headless-ecommerce/features/checkout/shipping-billing/shipping-methods">Shipping Methods</a> - How costs are calculated before payment selection.</li><li>üß± <a href="/bagisto-headless-ecommerce/features/checkout/checkout-flow/multi-step-checkout">Multi-step Checkout</a> - The overall checkout structure.</li></ul>`,27)])])}const E=i(n,[["render",h]]);export{c as __pageData,E as default};
