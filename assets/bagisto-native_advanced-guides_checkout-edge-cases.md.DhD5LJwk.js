import{j as a,c as t,b as s,ah as i}from"./chunks/framework.Br27zpCu.js";const u=JSON.parse('{"title":"Checkout Edge Cases","description":"","frontmatter":{},"headers":[],"relativePath":"bagisto-native/advanced-guides/checkout-edge-cases.md","filePath":"bagisto-native/advanced-guides/checkout-edge-cases.md","lastUpdated":1769089279000}'),o={name:"bagisto-native/advanced-guides/checkout-edge-cases.md"};function n(r,e,l,c,p,d){return s(),t("div",null,[...e[0]||(e[0]=[i(`<h1 id="checkout-edge-cases" tabindex="-1">Checkout Edge Cases <a class="header-anchor" href="#checkout-edge-cases" aria-label="Permalink to &quot;Checkout Edge Cases&quot;">​</a></h1><p>Checkout is the most critical part of the e-commerce flow. In a hybrid app, you face unique challenges regarding payments and 3rd-party redirects (PayPal, Stripe, etc.).</p><h2 id="_3rd-party-payment-redirects" tabindex="-1">3rd Party Payment Redirects <a class="header-anchor" href="#_3rd-party-payment-redirects" aria-label="Permalink to &quot;3rd Party Payment Redirects&quot;">​</a></h2><p>Many payment gateways redirect the user to their own domain (e.g., <code>paypal.com</code>) to complete payment, then redirect back to your <code>success_url</code>.</p><h3 id="the-problem" tabindex="-1">The Problem <a class="header-anchor" href="#the-problem" aria-label="Permalink to &quot;The Problem&quot;">​</a></h3><p>Turbo Native apps are configured to only &quot;capture&quot; URLs belonging to your domain (<code>your-store.com</code>). If a user navigates to <code>paypal.com</code>, the app might:</p><ol><li>Open it in an external browser (Safari/Chrome), breaking the app flow.</li><li>Or open it in a modal WebView without the bridge.</li></ol><h3 id="the-solution" tabindex="-1">The Solution <a class="header-anchor" href="#the-solution" aria-label="Permalink to &quot;The Solution&quot;">​</a></h3><p><strong>Native Configuration:</strong> You must configure your native app&#39;s routing rules to handle known payment domains dynamically.</p><ul><li><strong>Internal WebView</strong>: Allow <code>paypal.com</code>, <code>stripe.com</code>, etc., to open within the app&#39;s WebView (or a Modal WebView) so the user never leaves the app.</li></ul><p><strong>Web Configuration:</strong> Ensure your <code>success_url</code> and <code>cancel_url</code> point back to your main domain.</p><ul><li>Success: <code>https://your-store.com/checkout/success</code></li><li>Cancel: <code>https://your-store.com/checkout/cart</code></li></ul><p>When the payment provider redirects back to <code>your-store.com</code>, the native app recognizes the domain and resumes normal functionality.</p><h2 id="native-payment-sdks-apple-pay-google-pay" tabindex="-1">Native Payment SDKs (Apple Pay / Google Pay) <a class="header-anchor" href="#native-payment-sdks-apple-pay-google-pay" aria-label="Permalink to &quot;Native Payment SDKs (Apple Pay / Google Pay)&quot;">​</a></h2><p>If you want to use <strong>Apple Pay</strong> or <strong>Google Pay</strong>:</p><ol><li><strong>Web Request Basic</strong>: You can use the <a href="https://developer.mozilla.org/en-US/docs/Web/API/Payment_Request_API" target="_blank" rel="noreferrer">Payment Request API</a> which works in modern WebViews.</li><li><strong>Native Bridge (Advanced)</strong>: For a truly native experience, use a Bridge Component to trigger the native Apple Pay sheet. <ul><li>Web: <code>this.send(&quot;payment&quot;, { provider: &quot;apple_pay&quot;, total: 100.00 })</code></li><li>Native: Presents <code>PKPaymentAuthorizationViewController</code>.</li><li>Native: Returns the payment token to Web via <code>this.replyTo(&quot;payment&quot;, { token: &quot;...&quot; })</code>.</li><li>Web: Submits the token to the backend.</li></ul></li></ol><h2 id="order-success-hygiene" tabindex="-1">Order Success Hygiene <a class="header-anchor" href="#order-success-hygiene" aria-label="Permalink to &quot;Order Success Hygiene&quot;">​</a></h2><p>After a successful order:</p><ol><li><strong>Clear Cart</strong>: Ensure backend clears the cart.</li><li><strong>Sync Cart Count</strong>: Immediately send a bridge message to update the native cart badge to &quot;0&quot;.<div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// In success page controller</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">send</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;cartcount&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, { count: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;0&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> });</span></span></code></pre></div></li><li><strong>Rate App Prompt</strong>: This is a great time to ask for a review.<div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">send</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;system&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, { action: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;requestReview&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> });</span></span></code></pre></div></li></ol><h2 id="next-steps" tabindex="-1">Next Steps <a class="header-anchor" href="#next-steps" aria-label="Permalink to &quot;Next Steps&quot;">​</a></h2><ul><li>Explore <a href="./custom-bridge-components">Custom Bridge Components</a></li><li>Learn about <a href="./../deployment/hosting">Deployment</a></li><li>Understand <a href="./../getting-started/configure-and-run/environment-variables">Environment Variables</a></li></ul>`,21)])])}const g=a(o,[["render",n]]);export{u as __pageData,g as default};
