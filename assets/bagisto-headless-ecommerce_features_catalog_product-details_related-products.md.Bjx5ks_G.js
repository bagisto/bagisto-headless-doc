import{j as i,c as a,b as e,ah as t}from"./chunks/framework.Br27zpCu.js";const c=JSON.parse('{"title":"Related Products","description":"","frontmatter":{},"headers":[],"relativePath":"bagisto-headless-ecommerce/features/catalog/product-details/related-products.md","filePath":"bagisto-headless-ecommerce/features/catalog/product-details/related-products.md","lastUpdated":1768311009000}'),n={name:"bagisto-headless-ecommerce/features/catalog/product-details/related-products.md"};function l(h,s,p,r,d,k){return e(),a("div",null,[...s[0]||(s[0]=[t(`<h1 id="related-products" tabindex="-1">Related Products <a class="header-anchor" href="#related-products" aria-label="Permalink to &quot;Related Products&quot;">‚Äã</a></h1><p>This guide explains how to fetch and display related products on the product detail page in the Bagisto Headless storefront.</p><h2 id="overview" tabindex="-1">Overview <a class="header-anchor" href="#overview" aria-label="Permalink to &quot;Overview&quot;">‚Äã</a></h2><p>In Bagisto Headless, related products are cross-sell or up-sell items associated with a specific product in the backend. These products are fetched independently from the main product details, allowing for more flexible rendering and optimized performance through separate caching and revalidation.</p><h2 id="_1-graphql-query-fragments" tabindex="-1">1. GraphQL Query &amp; Fragments <a class="header-anchor" href="#_1-graphql-query-fragments" aria-label="Permalink to &quot;1. GraphQL Query &amp; Fragments&quot;">‚Äã</a></h2><p>The <code>GET_RELATED_PRODUCTS</code> query is used to retrieve a list of products related to a specific product ID or slug.</p><h3 id="related-products-query" tabindex="-1">Related Products Query <a class="header-anchor" href="#related-products-query" aria-label="Permalink to &quot;Related Products Query&quot;">‚Äã</a></h3><p>This query uses the <code>ProductSection</code> fragment to fetch a lightweight set of product data suitable for display in a carousel or grid.</p><p><strong>File:</strong> <code>src/graphql/catelog/queries/Product.ts</code></p><div class="language-graphql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">graphql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">query</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> GetRelatedProducts</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">$id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ID</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">$first</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  product</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">$id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    id</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    sku</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    relatedProducts</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">first</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">$first</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">      edges</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">        node</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">          ...</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">ProductSection</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h2 id="_2-frontend-implementation" tabindex="-1">2. Frontend Implementation <a class="header-anchor" href="#_2-frontend-implementation" aria-label="Permalink to &quot;2. Frontend Implementation&quot;">‚Äã</a></h2><p>Related products are implemented as a server component that is lazily loaded or wrapped in a <code>Suspense</code> boundary to prevent blocking the main product information.</p><h3 id="related-products-section-component" tabindex="-1">Related Products Section Component <a class="header-anchor" href="#related-products-section-component" aria-label="Permalink to &quot;Related Products Section Component&quot;">‚Äã</a></h3><p>The <code>RelatedProductsSection</code> component handles the data fetching and mapping of the related products.</p><p><strong>File:</strong> <code>src/components/catalog/product/RelatedProductsSection.tsx</code></p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> async</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> RelatedProductsSection</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({ </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">fullPath</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // Fetch related products data</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> fetchResult</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> getRelatedProduct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fullPath);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // Extract nodes from edges</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> relatedProducts</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> fetchResult?.relatedProducts?.edges</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    ?</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> fetchResult.relatedProducts.edges.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">map</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">e</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> e.node)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    :</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [];</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    &lt;</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">ProductsSection</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      title</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Related Products&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      description</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Discover similar products you might love.&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      products</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{relatedProducts}</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    /&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  );</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="async-data-fetching-utility" tabindex="-1">Async Data Fetching Utility <a class="header-anchor" href="#async-data-fetching-utility" aria-label="Permalink to &quot;Async Data Fetching Utility&quot;">‚Äã</a></h3><p>A nested function handles the GraphQL request with specific caching tags related to the product.</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> getRelatedProduct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">productIdentifier</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> graphqlRequest</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">SingleProductResponse</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;(</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    GET_RELATED_PRODUCTS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    { id: productIdentifier, first: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      tags: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;related-products&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\`product-\${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">productIdentifier</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}\`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      life: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;hours&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  );</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h2 id="_3-caching-performance" tabindex="-1">3. Caching &amp; Performance <a class="header-anchor" href="#_3-caching-performance" aria-label="Permalink to &quot;3. Caching &amp; Performance&quot;">‚Äã</a></h2><p>To ensure the related products section doesn&#39;t negatively impact the user experience, several strategies are used:</p><ul><li><strong>Isolated Fetching:</strong> By fetching related products separately, the initial load of the primary product information remains fast.</li><li><strong>Tag-based Revalidation:</strong> Uses the <code>related-products</code> tag. This allows the storefront to refresh related items globally or for a specific product without affecting other caches.</li><li><strong>Suspense Integration:</strong> In the main <code>ProductPage</code>, this component is wrapped in a <code>Suspense</code> boundary with a skeleton loader, providing immediate visual feedback while the data fetches.</li></ul><h2 id="summary" tabindex="-1">Summary <a class="header-anchor" href="#summary" aria-label="Permalink to &quot;Summary&quot;">‚Äã</a></h2><ul><li><strong>Independent Query:</strong> Fetches related items using a dedicated <code>GET_RELATED_PRODUCTS</code> query.</li><li><strong>Optimized Schema:</strong> Uses small fragments to reduce the payload size for listing related items.</li><li><strong>Progressive Rendering:</strong> Leverages React Suspense to improve perceived performance.</li><li><strong>Effective Caching:</strong> Uses Next.js tags for granular cache control.</li></ul><h2 id="next-steps" tabindex="-1">Next Steps <a class="header-anchor" href="#next-steps" aria-label="Permalink to &quot;Next Steps&quot;">‚Äã</a></h2><ul><li>üì¶ <a href="/bagisto-headless-ecommerce/features/catalog/product-listing/fetching-products">Product Listing</a> - How large product sets are managed.</li><li>üñºÔ∏è <a href="/bagisto-headless-ecommerce/features/catalog/product-details/product-images">Product Images</a> - Displaying images in product grids.</li></ul>`,26)])])}const g=i(n,[["render",l]]);export{c as __pageData,g as default};
